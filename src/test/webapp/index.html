<html>
<head>
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />
<script src="jms/jsm.js"></script>
<script src="nofold.js"></script>
</head>
<body>
	<script>
		var b = build(jsm, 'jms/');
		// cleanup
		while (b.Child.length > 0) {
			b.Child[0].remove();
		}
		while (b.Mother.length > 0) {
			b.Mother[0].remove();
		}
		if (b.Mother.length !== 0)
			throw 'Must have no mothers';
		var mother = b.Mother.push({
			name : 'Marry'
		});
		if (b.Mother.length !== 1)
			throw 'Must have one mother';
		if (b.Mother[0].name !== 'Marry')
			throw 'Mothers name must be marry.';
		b.Child.push({
			name : 'Tom',
			mother : mother
		});
		if (b.Child[0].mother.name !== 'Marry') {
			throw 'Mothers name must be Marry.';
		}

		if (b.Mother[0].childs.length != 1)
			throw 'Must have one child but has ' + b.Mother[0].childs.length;
		if (b.Mother[0].childs[0].name !== 'Tom')
			throw 'Name of child must be Tom';

		var jenny = b.Mother.push({
			name : 'Jenny'
		});

		console.log(b.Child.load(0));
		
		b.Child[0].mother = jenny;
		if (b.Child[0].mother.name != 'Jenny') {
			throw 'Mother must be jenny!';
		}

		var ok = true;
		try {
			b.Mother[1].remove();
			ok = false;
		} catch (e) {
		}
		if (!ok)
			throw 'Must fail to remove mother because child exists.';

		console.info("All fine!");
	</script>
</body>


</html>